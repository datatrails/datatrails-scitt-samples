# This workflow configures the repository specific choices of which CI builds
# must pass in order for a build to merge. This allows a sinlge global teraform
# configured rule to require a "well known" check in each repository. Whilst
# granting repository stakeholders the ability configure what workflows are
# appropriate to satisfy that check.
name: Merge Requires
on:
  push:

jobs:
  ci:
    secrets: inherit
    uses: ./github/workflows/ci.yml
  release:
    secrets: inherit
    uses: ./github/workflows/package.yml

  merge-checks-ok:
    needs: [ci]

  release-checks-ok:
    if: ${{ github.event_name == 'release' }}
    needs: [ci, release]